SELECT
	UU.PARENTXDRID,
	UU. LENGTH,
	UU.CITY,
	UU.INTERFACE,
	UU.XDRID,
	UU.RAT,
	S1.IMSI,
	S1.IMEI,
	S1.MSISDN,
	UU.PROCEDURETYPE,
	UU.PROCEDURESTARTTIME,
	UU.PROCEDUREENDTIME,
	UU.KEYWORD1,
	UU.KEYWORD2,
	UU.PROCEDURESTATUS,
	UU.PLMNID,
	UU.ENBID,
	UU.CELLID,
	UU.CRNTI,
	UU.TARGETENBID,
	UU.TARGETCELLID,
	UU.TARGETCRNTI,
	UU.MMEUES1APID,
	UU.MMEGROUPID,
	UU.MMECODE,
	UU.MTMSI,
	UU.CSFBINDICATION,
	UU.REDIRECTEDNETWORK,
	UU.EPSBEARERNUMBER,
	UU.BEARER0ID,
	UU.BEARER0STATUS,
	UU.BEARER1ID,
	UU.BEARER1STATUS,
	UU.BEARER2ID,
	UU.BEARER2STATUS,
	UU.BEARER3ID,
	UU.BEARER3STATUS,
	UU.BEARER4ID,
	UU.BEARER4STATUS,
	UU.BEARER5ID,
	UU.BEARER5STATUS,
	UU.BEARER6ID,
	UU.BEARER6STATUS,
	UU.BEARER7ID,
	UU.BEARER7STATUS,
	UU.BEARER8ID,
	UU.BEARER8STATUS,
	UU.BEARER9ID,
	UU.BEARER9STATUS,
	UU.BEARER10ID,
	UU.BEARER10STATUS,
	UU.BEARER11ID,
	UU.BEARER11STATUS,
	UU.BEARER12ID,
	UU.BEARER12STATUS,
	UU.BEARER13ID,
	UU.BEARER13STATUS,
	UU.BEARER14ID,
	UU.BEARER14STATUS,
	UU.BEARER15ID,
	UU.BEARER15STATUS,
	UU.RANGETIME
FROM
	TB_XDR_IFC_UU UU
LEFT OUTER JOIN (
	SELECT
		B.IMSI,
		B.IMEI,
		B.MSISDN,
		A .MMEUES1APID,
		A .MMEGROUPID,
		A .MMECODE,
		A .PROCEDUREENDTIME
	FROM
		(
			SELECT
				MMEUES1APID,
				MMEGROUPID,
				MMECODE,
				MIN (PROCEDUREENDTIME) PROCEDUREENDTIME
			FROM
				tb_Xdr_ifc_s1mme
			GROUP BY
				MMEUES1APID,
				MMEGROUPID,
				MMECODE
		) A
	INNER JOIN (
		SELECT
			IMSI,
			IMEI,
			MSISDN,
			MMEUES1APID,
			MMEGROUPID,
			MMECODE,
			PROCEDUREENDTIME
		FROM
			tb_Xdr_ifc_s1mme
	) B ON A .PROCEDUREENDTIME = B.PROCEDUREENDTIME
	AND A .MMEUES1APID = B.MMEUES1APID
	AND A .MMEGROUPID = B.MMEGROUPID
	AND A .MMECODE = B.MMECODE
) S1 ON UU.MMEUES1APID = S1.MMEUES1APID
AND UU.MMEGROUPID = S1.MMEGROUPID
AND UU.MMECODE = S1.MMECODE
WHERE
	UU.PROCEDUREENDTIME - S1.PROCEDUREENDTIME <= 600000